import{_ as le}from"./CwfwSP2l.js";import{r as o,m as ie,f as se,n as ae,c as a,a as t,b as re,w as oe,F as m,q as g,D as s,t as n,z as A,s as ne,p as y,v as I,E as h,u as S,o as r,d as de,G as L}from"./B8_WjUqw.js";import{u as v}from"./BMbFKR4x.js";const ue={class:"p-6 max-w-full mx-auto bg-white rounded-lg shadow-lg"},me={class:"mb-4"},ce={class:"min-w-full bg-white rounded-lg shadow-lg border border-gray-300"},ge={class:"py-2 px-4 text-gray-700 border-r border-gray-300"},be={class:"py-2 px-4 text-gray-700 border-r border-gray-300"},pe={class:"py-2 px-4 text-gray-700 border-r border-gray-300"},ye={class:"py-2 px-4 text-gray-700"},ve=["onClick"],fe={key:0,class:"mt-2 border-t border-gray-300 pt-2"},xe={class:"text-red-400"},ke={class:"mt-2 ml-4 list-disc"},he={class:"font-bold"},we={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50"},_e={class:"bg-white p-6 rounded-lg shadow-lg max-w-md w-full max-h-screen overflow-y-auto"},Ee={class:"text-2xl font-bold mb-4"},Te={class:"list-disc ml-6"},Ke={key:1,class:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50"},$e={class:"bg-white p-6 rounded-lg shadow-lg max-w-md w-full max-h-screen overflow-y-auto"},Ve={class:"text-2xl mb-4"},Ce={class:"mb-4"},Fe=["value"],Me={class:"mb-4"},Ae=["required"],Ie=["value"],Se={class:"mb-4"},De={class:"grid grid-cols-2 gap-2"},Ue=["value"],qe={class:"flex-1 flex space-x-2"},ze={class:"mb-4"},Be=["value"],Ne={class:"mb-4"},Ge={key:0},Re=["value"],Ye={key:1,class:"text-sm text-gray-500"},Le={class:"mb-4"},Oe={class:"mb-4"},je={class:"mb-4"},He={class:"space-y-2"},Je={type:"submit",class:"bg-blue-600 text-white py-2 px-4 rounded-md w-full"},We={__name:"index",setup(Xe){const O=o([]),K=o(null),D=o(!1),U=o([]),q=o([]),$=o([]),x=o(null),k=o([]),V=o(!1),C=o(!1),d=o({id:null,egitimTarihi:"",gecerlilikTarihi:"",sure:""}),z=o([]),F=o([]),M=o([]),b=o(null),f=o(null),w=o([]);o(null);const j=async()=>{const{data:i}=await v("/api/kategori/get","$3rbJXsEMnC");O.value=i.value||[]},_=o(null),H=i=>{_.value=_.value===i?null:i},J=ie(()=>{const i={};return U.value.forEach(e=>{var Y;const c=e.calisan.id,l=`${e.calisan.adi} ${e.calisan.soyadi}`,u=e.calisan.firma.firmaAdi,E=((Y=e.calisan.yerleske)==null?void 0:Y.subeAdi)||"Merkez",T=e.egitimTarihi;i[c]||(i[c]={calisanName:l,firmaAdi:u,yerleskeAdi:E,egttarih:T,kategoriler:{}});const p=e.egitimKonu.kategori.isim;i[c].kategoriler[p]||(i[c].kategoriler[p]=[]),i[c].kategoriler[p].push({baslik:e.egitimKonu.baslik,egitimTarihi:e.egitimTarihi,gecerlilikTarihi:e.gecerlilikTarihi})}),i});o(null);const X=()=>{D.value=!1,K.value=null},P=async()=>{const{data:i}=await v("/api/firma/get","$K1I4zjrJko");z.value=i.value,console.log("fİRMA",i)},Z=async()=>{if(b.value){const{data:i}=await v(`/api/yerleske/getByFirmaId?firmaId=${b.value}`,"$iRnH0US2dn");F.value=i.value}},B=async()=>{let i="";if(f.value?i=`/api/calisan/getByYerleskeId?yerleskeId=${f.value}`:b.value&&(i=`/api/calisan/getByFirmaId?firmaId=${b.value}`),i){const{data:e}=await v(i,"$YxkwfVwZHg");M.value=e.value||[]}else M.value=[]};se([b,f],()=>{B()},{immediate:!0});const Q=async()=>{const{data:i}=await v("/api/kategori/get","$52Ft8amFlh");q.value=i.value||[]},W=async()=>{if(x.value){const{data:i}=await v(`/api/egitimkonu/getByKategoriId?kategoriId=${x.value}`,"$REhuiNjLK1");$.value=i.value||[]}},N=async()=>{const{data:i}=await v("/api/egitim/get","$L1OnOs6Gp0");U.value=i.value||[]},ee=i=>{C.value=!!i,k.value=[],d.value={id:null,egitimTarihi:"",gecerlilikTarihi:"",sure:""},V.value=!0},G=()=>{V.value=!1},te=async()=>{const i=[];for(const e of w.value)for(const c of k.value)i.push({calisanId:e,egitimKonuId:c,egitimTarihi:d.value.egitimTarihi,gecerlilikTarihi:d.value.gecerlilikTarihi,sure:d.value.sure,belge:d.value.belge||null});try{await v("/api/egitim/post",{method:"POST",body:{payloads:i}},"$Y6mnXyVOpV"),alert("Eğitimler başarıyla kaydedildi."),N(),G()}catch(e){console.error("Eğitim kaydedilirken bir hata oluştu:",e),alert("Eğitim kaydedilirken bir hata oluştu. Lütfen tekrar deneyin.")}},R=i=>new Date(i).toLocaleDateString("tr-TR");return ae(()=>{Q(),N(),P(),j()}),(i,e)=>{const c=le;return r(),a(m,null,[t("div",ue,[e[22]||(e[22]=t("h1",{class:"text-2xl font-semibold mb-6"},"Eğitimler",-1)),t("div",me,[t("button",{onClick:e[0]||(e[0]=l=>ee(null)),class:"bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-md"}," Yeni Eğitim Ekle "),re(c,{to:"/egitimler/ekle",class:"bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md ml-4"},{default:oe(()=>e[12]||(e[12]=[de(" Eğitim Konusu Ekle ")])),_:1})]),t("table",ce,[e[13]||(e[13]=t("thead",null,[t("tr",{class:"border-b border-gray-300"},[t("th",{class:"py-2 px-4 bg-gray-200 text-gray-600 font-semibold text-sm uppercase border-r border-gray-300"},"Çalışan Adı"),t("th",{class:"py-2 px-4 bg-gray-200 text-gray-600 font-semibold text-sm uppercase border-r border-gray-300"},"Firma Adı"),t("th",{class:"py-2 px-4 bg-gray-200 text-gray-600 font-semibold text-sm uppercase border-r border-gray-300"},"Taşeron Adı"),t("th",{class:"py-2 px-4 bg-gray-200 text-gray-600 font-semibold text-sm uppercase"},"Eğitim Kategorileri ve Detaylar")])],-1)),t("tbody",null,[(r(!0),a(m,null,g(s(J),(l,u)=>(r(),a("tr",{key:u,class:"border-b border-gray-300"},[t("td",ge,n(l.calisanName),1),t("td",be,n(l.firmaAdi),1),t("td",pe,n(l.yerleskeAdi),1),t("td",ye,[t("button",{onClick:E=>H(u),class:"text-blue-500 hover:text-blue-700"},n(s(_)===u?"Detayları Gizle":"Detayları Gör"),9,ve),s(_)===u?(r(),a("div",fe,[(r(!0),a(m,null,g(l.kategoriler,(E,T)=>(r(),a("div",{key:T,class:"mb-4"},[t("strong",xe,n(T),1),t("ul",ke,[(r(!0),a(m,null,g(E,p=>(r(),a("li",{key:p.baslik,class:"mb-2"},[t("strong",he,n(p.baslik),1),t("div",null,"Tarih: "+n(R(p.egitimTarihi)),1),t("div",null,"Geçerlilik Tarihi: "+n(R(p.gecerlilikTarihi)),1)]))),128))])]))),128))])):A("",!0)])]))),128))])]),s(D)?(r(),a("div",we,[t("div",_e,[t("h2",Ee,n(s(K).isim),1),t("ul",Te,[(r(!0),a(m,null,g(s(K).egitimKonular,l=>(r(),a("li",{key:l.id},n(l.baslik),1))),128))]),t("button",{onClick:X,class:"mt-4 bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg"}," Kapat ")])])):A("",!0),s(V)?(r(),a("div",Ke,[t("div",$e,[t("h2",Ve,n(s(C)?"Eğitimi Düzenle":"Yeni Eğitim Ekle"),1),t("form",{onSubmit:ne(te,["prevent"])},[t("div",Ce,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-600"},"Firma Seçimi",-1)),y(t("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>h(b)?b.value=l:null),onChange:e[2]||(e[2]=l=>Z()),class:"border p-2 w-full rounded-md",required:""},[(r(!0),a(m,null,g(s(z),l=>(r(),a("option",{key:l.id,value:l.id},n(l.firmaAdi),9,Fe))),128))],544),[[I,s(b)]])]),t("div",Me,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-600"},"Taşeron Seçimi",-1)),y(t("select",{"onUpdate:modelValue":e[3]||(e[3]=l=>h(f)?f.value=l:null),onChange:e[4]||(e[4]=l=>B()),class:"border p-2 w-full rounded-md",required:s(F).length>0},[(r(!0),a(m,null,g(s(F),l=>(r(),a("option",{key:l.id,value:l.id},n(l.subeAdi),9,Ie))),128))],40,Ae),[[I,s(f)]])]),t("div",Se,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-600"},"Çalışan Seçimi",-1)),t("div",De,[(r(!0),a(m,null,g(s(M),l=>(r(),a("div",{key:l.id,class:"flex items-center border-b border-gray-200 py-2 px-4"},[y(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=u=>h(w)?w.value=u:null),value:l.id,class:"mr-4"},null,8,Ue),[[L,s(w)]]),t("div",qe,[t("span",null,n(l.adi),1),t("span",null,n(l.soyadi),1)])]))),128))])]),t("div",ze,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-600"},"Eğitim Kategorisi",-1)),y(t("select",{"onUpdate:modelValue":e[6]||(e[6]=l=>h(x)?x.value=l:null),onChange:e[7]||(e[7]=l=>W()),class:"border p-2 w-full rounded-md",required:""},[(r(!0),a(m,null,g(s(q),l=>(r(),a("option",{key:l.id,value:l.id},n(l.isim),9,Be))),128))],544),[[I,s(x)]])]),t("div",Ne,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-600"},"Eğitim Konuları",-1)),s($).length>0?(r(),a("div",Ge,[(r(!0),a(m,null,g(s($),l=>(r(),a("div",{key:l.id,class:"flex items-center mb-2"},[y(t("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=u=>h(k)?k.value=u:null),value:l.id,class:"mr-2"},null,8,Re),[[L,s(k)]]),t("span",null,n(l.baslik),1)]))),128))])):(r(),a("p",Ye,"Bu kategoride eğitim konusu bulunmamaktadır."))]),t("div",Le,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-600"},"Eğitim Süresi",-1)),y(t("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>s(d).sure=l),type:"number",min:"1",class:"border p-2 w-full rounded-md",placeholder:"Saat veya dakika olarak giriniz",required:""},null,512),[[S,s(d).sure]])]),t("div",Oe,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-600"},"Eğitim Tarihi",-1)),y(t("input",{"onUpdate:modelValue":e[10]||(e[10]=l=>s(d).egitimTarihi=l),type:"date",class:"border p-2 w-full rounded-md",required:""},null,512),[[S,s(d).egitimTarihi]])]),t("div",je,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-gray-600"},"Geçerlilik Tarihi",-1)),y(t("input",{"onUpdate:modelValue":e[11]||(e[11]=l=>s(d).gecerlilikTarihi=l),type:"date",class:"border p-2 w-full rounded-md",required:""},null,512),[[S,s(d).gecerlilikTarihi]])]),t("div",He,[t("button",Je,n(s(C)?"Güncelle":"Kaydet"),1),t("button",{onClick:G,class:"bg-red-600 text-white py-2 px-4 rounded-md w-full"},"Kapat")])],32)])])):A("",!0)]),e[23]||(e[23]=t("div",null,null,-1))],64)}}};export{We as default};
