{"file":"ekle-D6UBAbTk.js","mappings":";;;;;;;;;;;;AAyEc,aAAS;AACR,cAAU;AAEzB,UAAM,UAAU,IAAI,EAAE;AACtB,UAAM,UAAU,IAAI,EAAE;AACtB,UAAM,QAAQ,IAAI,EAAE;AACpB,UAAM,gBAAgB,IAAI,EAAE;AAC5B,UAAM,YAAY,IAAI,EAAE;AACxB,UAAM,UAAU,IAAI,EAAE;AACtB,UAAM,UAAU,IAAI,EAAE;AACtB,UAAM,aAAa,IAAI,EAAE;AACzB,UAAM,WAAW,IAAI,CAAA,CAAE;;;;;;;;;;;;;;;;;;;;;;","names":[],"sources":["../../../../pages/yerleske/ekle.vue"],"sourcesContent":["<template>\n  <div class=\"p-8 mx-auto max-w-2xl  bg-white rounded-lg shadow-lg\">\n    <h1 class=\"text-3xl font-bold text-center text-gray-800 mb-6\">Yeni Taşeron Ekle</h1>\n    <form @submit.prevent=\"addYerleske\" class=\"space-y-4\">\n      <div>\n        <label class=\"block text-sm font-medium text-gray-600\">Firma ID</label>\n        <input v-model=\"firmaId\" type=\"text\" class=\"border border-gray-300 p-2 w-full rounded-md\" readonly />\n      </div>\n      <div>\n        <label class=\"block text-sm font-medium text-gray-600\">Taşeron Adı</label>\n        <input v-model=\"subeAdi\" type=\"text\" class=\"border border-gray-300 p-2 w-full rounded-md\" required />\n      </div>\n      <div>\n        <label class=\"block text-sm font-medium text-gray-600\">Adres</label>\n        <input v-model=\"adres\" type=\"text\" class=\"border border-gray-300 p-2 w-full rounded-md\" required />\n      </div>\n\n      <!-- SGK Sicil No, NACE Kodu ID ve Tehlike Sınıfı aynı satır -->\n      <div class=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n        <div>\n          <label class=\"block text-sm font-medium text-gray-600\">SGK Sicil No</label>\n          <input v-model=\"sgkSicilNo\"  @input=\"fetchNaceCodes\" type=\"text\" class=\"border border-gray-300 p-2 w-full rounded-md\" required />\n        </div>\n        \n   \n        <div>\n          <label class=\"block text-sm font-medium text-gray-600\">NACE Kodu ID</label>\n          <input v-model=\"naceKodID\" type=\"text\" class=\"border border-gray-300 p-2 w-40 rounded-md\" required />\n        </div>\n        <div>\n          <label class=\"block text-sm font-medium text-gray-600\">Tehlike Sınıfı</label>\n          <input v-model=\"tehlikeSinifi\" class=\"border border-gray-300 p-2 w-40 rounded-md\" />\n        </div>\n      </div>\n      <div v-if=\"naceList.length > 0\" class=\"mt-4\">\n  <label class=\"block text-gray-600 mb-1\">NACE Kodları</label>\n  <div v-for=\"nace in naceList\" :key=\"nace.id\" class=\"flex items-center\">\n    <input\n      type=\"radio\"\n      :value=\"nace.id\"\n      v-model=\"naceKodID\"\n      @change=\"updateTehlikeSinifi(nace)\"\n      class=\"mr-2\"\n    />\n    <span>{{ nace.kod }} -  ({{ nace.tehlikeSinifi }})</span>\n  </div>\n</div>\n\n      <!-- Yetkili ve Telefon aynı satır -->\n      <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n        <div>\n          <label class=\"block text-sm font-medium text-gray-600\">Telefon</label>\n          <input v-model=\"telefon\" type=\"tel\" class=\"border border-gray-300 p-2 w-full rounded-md\" />\n        </div>\n        <div>\n          <label class=\"block text-sm font-medium text-gray-600\">Yetkili</label>\n          <input v-model=\"yetkili\" type=\"text\" class=\"border border-gray-300 p-2 w-full rounded-md\" required />\n        </div>\n      </div>\n\n      <button type=\"submit\" class=\"bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md w-full font-semibold\">\n        Kaydet\n      </button>\n    </form>\n  </div>\n</template>\n\n\n<script setup>\nimport { ref, onMounted } from 'vue'\nimport { useRoute, useRouter } from 'vue-router'\nimport { useFetch } from '#app'\n\nconst route = useRoute()\nconst router = useRouter()\n\nconst firmaId = ref('')\nconst subeAdi = ref('')\nconst adres = ref('')\nconst tehlikeSinifi = ref('')\nconst naceKodID = ref('')\nconst telefon = ref('')\nconst yetkili = ref('')\nconst sgkSicilNo = ref('')\nconst naceList = ref([]);\n\nonMounted(() => {\n  firmaId.value = route.query.firmaId || ''\n})\n\nconst addYerleske = async () => {\n  await useFetch('/api/yerleske/post', {\n    method: 'POST',\n    body: {\n      firmaId: firmaId.value,\n      subeAdi: subeAdi.value,\n      adres: adres.value,\n      naceKodID: naceKodID.value,\n      telefon: telefon.value,\n      yetkili: yetkili.value,\n      sgkSicilNo: sgkSicilNo.value,\n    },\n  })\n  alert('Yerleşke başarıyla eklendi!')\n  router.push('/firma')\n}\n\nconst delay = (ms) => new Promise((resolve) => setTimeout(resolve, ms));\n\nconst fetchNaceCodes = async () => {\n  // SGK Sicil No kontrolü\n  if (sgkSicilNo.value.length >= 4) {\n    await delay(2000); // Gecikme eklenir\n    try {\n      const { data } = await useFetch('/api/firma/nace-search', {\n        method: 'POST',\n        body: { sgkSicilNo: sgkSicilNo.value },\n      });\n      naceList.value = data.value || []; // Gelen veriyi listeye atar\n    } catch (error) {\n      console.error(\"NACE Kodları API hatası:\", error);\n      naceList.value = []; // Hata durumunda listeyi sıfırla\n    }\n  } else {\n    // SGK Sicil No 4 karakterden küçükse listeyi boşalt\n    naceList.value = [];\n  }\n};\nconst updateTehlikeSinifi = (nace) => {\n  tehlikeSinifi.value = nace.tehlikeSinifi; // Tehlike sınıfını atar\n};\n</script>\n"],"version":3}