{"file":"index-C6oDYMw_.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAoJe,cAAU;AACzB,UAAM,cAAc,IAAI,EAAE,MAAM,GAAE,CAAE;AACpC,UAAM,cAAc,IAAI,EAAE;AACE,QAAI,CAAC,GAAG,YAAY,KAAK,CAAC;AAEtD,UAAM,sBAAsB,IAAI,KAAK;AACV,QAAI,KAAK;AACpC,UAAM,iBAAiB,IAAI,IAAI;AAC/B,UAAM,aAAa,IAAI,KAAK;AAC5B,UAAM,qBAAqB,IAAI;AAAA,MAC7B,IAAG;AAAA,MACH,SAAS;AAAA,MACT,OAAO;AAAA,MACP,eAAe;AAAA,MACf,UAAU;AAAA,MACV,SAAS;AAAA,MACT,SAAS;AAAA,MACT,YAAY;AAAA,IACd,CAAC;AACkB,QAAI,EAAE;AACH,QAAI,EAAE;AACF,QAAI,IAAI;AA4BlC,UAAM,oBAAoB,SAAS,MAAM;AACvC,aAAO,YAAY,MAAM;AAAA,QAAO,SAC9B,IAAI,MAAM,SAAS,YAAa,EAAC,SAAS,YAAY,MAAM,KAAK,aAAa;AAAA,MAChF;AAAA,IACF,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","names":[],"sources":["../../../../pages/yerleske/index.vue"],"sourcesContent":["<template>\n  <div class=\"p-4 max-w-full mx-auto bg-white rounded-lg shadow-lg\">\n    <!-- Firma ID ile Arama -->\n    <h1 class=\"text-3xl font-semibold mb-6 text-gray-800\">Şubeler</h1>\n   \n     <!-- Arama Alanları -->\n     <div class=\"flex flex-wrap items-center mb-4\">\n      <input \n        v-model=\"searchQuery.name\"\n        type=\"text\" \n        placeholder=\"Firma Adında Ara\" \n        class=\"w-full md:w-1/6 p-2 border rounded-lg mr-2 mb-2\"\n      />\n  \n    </div>\n    \n    <!-- Yerleşke Tablosu -->\n    <table class=\"w-full border-collapse bg-white text-left shadow-md rounded-md\">\n      <thead>\n        <tr class=\"bg-gray-200 text-gray-700\">\n          <th class=\"p-3 border-b\">Firma  Adı</th>\n          <th class=\"p-3 border-b\">Şube Adı</th>\n          <th class=\"p-3 border-b\">Adres</th>\n          <th class=\"p-3 border-b\">NACE Kodu</th>\n          <th class=\"p-3 border-b\">Tehlike Sınıfı</th>\n          <th class=\"p-3 border-b\">Telefon</th>\n          <th class=\"p-3 border-b\">Yetkili</th>\n          <th class=\"p-3 border-b\">SGK Sicil No</th>\n          <th class=\"p-3 border-b text-center\">İşlemler</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"yerleske in filterYerleskeler\" :key=\"yerleske.id\" class=\"border-b\">\n          <td class=\"p-3\">{{ yerleske.firma.firmaAdi }}</td>\n          <td class=\"p-3\">{{ yerleske.subeAdi }}</td>\n          <td class=\"p-3\">{{ yerleske.adres }}</td>\n          <td class=\"p-3\">{{ yerleske.nace.kod }}</td>\n          <td class=\"p-3\">{{ yerleske.nace.tehlikeSinifi }}</td>\n          <td class=\"p-3\">{{ yerleske.telefon }}</td>\n          <td class=\"p-3\">{{ yerleske.yetkili }}</td>\n          <td class=\"p-3\">{{ yerleske.sgkSicilNo }}</td>\n        \n          <!--yENİ mENU-->\n          <td class=\"p-3 text-center flex justify-center space-x-2\">\n  <!-- Düzenle Düğmesi -->\n  <button @click=\"editYerleske(yerleske)\" class=\"bg-yellow-500 hover:bg-yellow-600 text-white px-2 py-2 rounded-lg inline-flex items-center\">\n    <Icon name=\"mdi-pencil\" class=\"w-5 h-5\" />\n  </button>\n\n  <!-- Sil Düğmesi -->\n  <button @click=\"deleteFirma(yerleske.id)\" class=\"bg-red-500 hover:bg-red-600 text-white px-2 py-2 rounded-lg inline-flex items-center\">\n    <Icon name=\"mdi-trash-can\" class=\"w-5 h-5\" />\n  </button>\n\n\n    <!-- Dropdown Menüsü -->\n   <div class=\"relative\">\n<button @click=\"toggleDropdown(yerleske.id)\" class=\"bg-gray-500 hover:bg-gray-600 text-white px-2 py-2 rounded-lg inline-flex items-center\">\n        <Icon name=\"mdi-dots-vertical\" class=\"w-5 h-5\" />\n      </button>\n       <!-- Sadece activeDropdown ile eşleşen id için menü açılır -->\n      <div v-if=\"activeDropdown === yerleske.id\" class=\"absolute right-0 mt-2 w-40 bg-white border border-gray-200 rounded-lg shadow-lg z-50\">\n        <ul class=\"py-1\">\n          <li>\n            <button @click=\"addCalisan(yerleske.firma.id, yerleske.id)\" class=\"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center\">\n             <Icon name=\"mdi-plus\" class=\"w-5 h-5 mr-2 text-gray-500 align-middle leading-none\" />\n            <span class=\"align-middle leading-none\">Çalışan Ekle</span>\n            </button>\n          </li>\n          <!-- Diğer menü seçenekleri -->\n        </ul>\n      </div>\n   </div>\n      \n\n     \n    </td>\n    <!---TesMenu-->\n    \n \n         \n        </tr>\n      </tbody>\n    </table>\n\n    <!-- Yerleşke Ekleme Modal -->\n    <div v-if=\"isYerleskeModalOpen\" class=\"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50\">\n     \n      <div class=\"bg-white p-6 rounded-lg shadow-lg max-w-md w-full\">\n        <h2 class=\"text-2xl mb-4\">{{ isEditMode ? 'Yerleşke Düzenle' : 'Yeni Yerleşke Ekle' }}</h2>\n        \n        <form @submit.prevent=\"saveYerleske\">\n          <!-- Form Alanları -->\n          <div class=\"mb-4\" v-for=\"(item, key) in yerleskeFormFields\" :key=\"key\">\n            <label class=\"block text-sm font-medium text-gray-600\">{{ key }}</label>\n            <input v-model=\"yerleskeFormFields[key]\" type=\"text\" class=\"border p-2 w-full rounded-md\" required />\n          </div>\n          <button type=\"submit\" class=\"bg-blue-600 text-white py-2 px-4 rounded-md w-full flex items-center justify-center space-x-2\">\n    <Icon name=\"mdi-content-save\" class=\"w-5 h-5\" />\n    <span>Kaydet</span>\n  </button>\n          <button @click=\"closeYerleskeModal\" class=\"bg-red-600 text-white py-2 px-4 mt-3 rounded-md w-full flex items-center justify-center space-x-2\">\n            <Icon name=\"mdi-close\" class=\"w-5 h-5\" />\n            <span>Kapat</span>\n          </button>\n        </form>\n        \n      </div>\n      \n    </div>\n\n    <!-- Çalışan Ekle Modal\n    <div v-if=\"isCalisanModalOpen\" class=\"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50\">\n      <div class=\"bg-white p-6 rounded-lg shadow-lg max-w-md w-full\">\n        <h2 class=\"text-2xl mb-4\">Çalışan Ekle</h2>\n        <form @submit.prevent=\"addCalisan\">\n          <div class=\"mb-4\">\n            <label class=\"block text-sm font-medium text-gray-600\">Adı</label>\n            <input v-model=\"calisanAdi\" type=\"text\" class=\"border p-2 w-full rounded-md\" required />\n          </div>\n          <div class=\"mb-4\">\n            <label class=\"block text-sm font-medium text-gray-600\">Soyadı</label>\n            <input v-model=\"calisanSoyadi\" type=\"text\" class=\"border p-2 w-full rounded-md\" required />\n          </div>\n          <button type=\"submit\" class=\"bg-blue-600 text-white py-2 px-4 rounded-md w-full flex items-center justify-center space-x-2\">\n            <Icon name=\"mdi-content-save\" class=\"w-5 h-5\" />\n            Kaydet\n          </button>\n \n        </form>\n        <button @click=\"closeCalisanModal\" type=\"button\" class=\"flex items-center justify-center space-x-2 bg-red-600 text-white py-2 px-4 mt-3 rounded-md w-full \">\n        <Icon name=\"mdi-close\" class=\"w-5 h-5\" />\n        Kapat\n        </button>\n      </div>\n    </div> -->\n  </div>\n  <br>\n  <br>\n\n \n</template>\n\n<script setup>\nimport { ref } from 'vue'\nimport { useFetch } from '#app'\nimport { useRouter } from 'vue-router'\n\nconst router = useRouter()\nconst searchQuery = ref({ name: '' })\nconst yerleskeler = ref([])\nconst filteredYerleskeler = ref([...yerleskeler.value])\n\nconst isYerleskeModalOpen = ref(false)\nconst isCalisanModalOpen = ref(false)\nconst activeDropdown = ref(null)\nconst isEditMode = ref(false)\nconst yerleskeFormFields = ref({\n  id:'',\n  subeAdi: '',\n  adres: '',\n  tehlikeSinifi: 'Düşük',\n  naceKodu: '',\n  telefon: '',\n  yetkili: '',\n  sgkSicilNo: ''\n})\nconst calisanAdi = ref('')\nconst calisanSoyadi = ref('')\nconst currentYerleskeId = ref(null)\n\nconst fetchYerleske = async () => {\n  const { data } = await useFetch('/api/yerleske/get')\n  yerleskeler.value = data.value;\n  \n}\nonMounted(()=>{\n  fetchYerleske();\n  console.log('Sayfa Yüklendi',yerleskeler)\n\n})\n\n// Çalışan ekleme sayfasına yönlendirme\nconst addCalisan = (firmaId, yerleskeId) => {\n  router.push({ path: '/calisanlar/ekle', query: { firmaId, yerleskeId } })\n \n}\n\nconst toggleDropdown = (id) => {\n  activeDropdown.value = activeDropdown.value === id ? null : id\n // activeDropdown.value = activeDropdown.value === id ? null : id\n}\n\n// const filterYerleskeler = () => {\n//   filteredYerleskeler.value = yerleskeler.value.filter(yerleske => yerleske.firmaId.toString().includes(searchQuery.value))\n// }\n\nconst filterYerleskeler = computed(() => {\n  return yerleskeler.value.filter(yer =>\n    yer.firma.firmaAdi.toLowerCase().includes(searchQuery.value.name.toLowerCase()) \n  )\n})\n\nconst openYerleskeModal = (isEdit = false, yerleske = null) => {\n  isEditMode.value = isEdit;\n  if (isEdit && yerleske) {\n    // Gelen yerleske verisini yerleskeFormFields içine atıyoruz\n    yerleskeFormFields.value = {\n      id:yerleske.id || '',\n      subeAdi: yerleske.subeAdi || '',\n      adres: yerleske.adres || '',\n      tehlikeSinifi: yerleske.tehlikeSinifi || 'Düşük',\n      naceKodu: yerleske.naceKodu || '',\n      telefon: yerleske.telefon || '',\n      yetkili: yerleske.yetkili || '',\n      sgkSicilNo: yerleske.sgkSicilNo || ''\n    };\n  } else {\n    // Yeni bir yerleske ekleniyorsa formu sıfırla\n    yerleskeFormFields.value = {\n      subeAdi: '',\n      adres: '',\n      tehlikeSinifi: 'Düşük',\n      naceKodu: '',\n      telefon: '',\n      yetkili: '',\n      sgkSicilNo: ''\n    };\n  }\n  isYerleskeModalOpen.value = true;\n};\nconst editYerleske = (yerleske) => {\n  openYerleskeModal(true, yerleske)\n}\n\nconst saveYerleske = async () => {\n  if (isEditMode.value) {\n    // Güncelleme isteği gönderin\n    await useFetch(`/api/yerleske/${yerleskeFormFields.value.id}`, {\n      method: 'PUT',\n      body: yerleskeFormFields.value\n    })\n  } else {\n    // Yeni kayıt isteği gönderin\n    await useFetch('/api/yerleske', {\n      method: 'POST',\n      body: yerleskeFormFields.value\n    })\n  }\n  closeYerleskeModal()\n  fetchYerleske()\n}\n\nconst deleteYerleske = async (id) => {\n  await useFetch(`/api/yerleske/${id}`, { method: 'DELETE' })\n  filterYerleskeler()\n}\n\nconst openCalisanModal = (yerleskeId) => {\n  currentYerleskeId.value = yerleskeId\n  isCalisanModalOpen.value = true\n}\n\n\n\nconst closeYerleskeModal = () => isYerleskeModalOpen.value = false\nconst closeCalisanModal = () => isCalisanModalOpen.value = false\n</script>\n"],"version":3}