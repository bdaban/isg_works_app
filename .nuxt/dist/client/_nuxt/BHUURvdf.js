import $ from"./DyiwFOnw.js";import{y as z,r as o,n as V,m as T,c as d,a as e,p as w,u as k,F as g,q as y,D as j,t as a,s as B,b as u,z as S,o as r}from"./B8_WjUqw.js";import{u as v}from"./BMbFKR4x.js";const E={class:"p-4 max-w-full mx-auto bg-white rounded-lg shadow-lg"},U={class:"flex flex-wrap items-center mb-4"},q={class:"w-full border-collapse bg-white text-left shadow-md rounded-md"},G={class:"p-3"},L={class:"p-3"},P={class:"p-3"},O={class:"p-3"},Q={class:"p-3"},X={class:"p-3"},I={class:"p-3"},J={class:"p-3"},R={class:"p-3 text-center flex justify-center space-x-2"},H=["onClick"],W=["onClick"],Z={class:"relative"},ee=["onClick"],te={key:0,class:"absolute right-0 mt-2 w-40 bg-white border border-gray-200 rounded-lg shadow-lg z-50"},se={class:"py-1"},le=["onClick"],oe={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50"},ae={class:"bg-white p-6 rounded-lg shadow-lg max-w-md w-full"},ne={class:"text-2xl mb-4"},ie={class:"block text-sm font-medium text-gray-600"},de=["onUpdate:modelValue"],re={type:"submit",class:"bg-blue-600 text-white py-2 px-4 rounded-md w-full flex items-center justify-center space-x-2"},be={__name:"index",setup(ce){const C=z(),p=o({name:""}),m=o([]);o([...m.value]);const b=o(!1);o(!1);const f=o(null),h=o(!1),n=o({id:"",subeAdi:"",adres:"",tehlikeSinifi:"Düşük",naceKodu:"",telefon:"",yetkili:"",sgkSicilNo:""});o(""),o(""),o(null);const x=async()=>{const{data:l}=await v("/api/yerleske/get","$zXtlGpGQbz");m.value=l.value};V(()=>{x(),console.log("Sayfa Yüklendi",m)});const A=(l,t)=>{C.push({path:"/calisanlar/ekle",query:{firmaId:l,yerleskeId:t}})},Y=l=>{f.value=f.value===l?null:l},N=T(()=>m.value.filter(l=>l.firma.firmaAdi.toLowerCase().includes(p.value.name.toLowerCase()))),D=(l=!1,t=null)=>{h.value=l,l&&t?n.value={id:t.id||"",subeAdi:t.subeAdi||"",adres:t.adres||"",tehlikeSinifi:t.tehlikeSinifi||"Düşük",naceKodu:t.naceKodu||"",telefon:t.telefon||"",yetkili:t.yetkili||"",sgkSicilNo:t.sgkSicilNo||""}:n.value={subeAdi:"",adres:"",tehlikeSinifi:"Düşük",naceKodu:"",telefon:"",yetkili:"",sgkSicilNo:""},b.value=!0},F=l=>{D(!0,l)},K=async()=>{h.value?await v(`/api/yerleske/${n.value.id}`,{method:"PUT",body:n.value},"$lBPgz0raCJ"):await v("/api/yerleske",{method:"POST",body:n.value},"$gMhwu4b6Xf"),_(),x()},_=()=>b.value=!1;return(l,t)=>{const c=$;return r(),d(g,null,[e("div",E,[t[5]||(t[5]=e("h1",{class:"text-3xl font-semibold mb-6 text-gray-800"},"Şubeler",-1)),e("div",U,[w(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>p.value.name=s),type:"text",placeholder:"Firma Adında Ara",class:"w-full md:w-1/6 p-2 border rounded-lg mr-2 mb-2"},null,512),[[k,p.value.name]])]),e("table",q,[t[2]||(t[2]=e("thead",null,[e("tr",{class:"bg-gray-200 text-gray-700"},[e("th",{class:"p-3 border-b"},"Firma Adı"),e("th",{class:"p-3 border-b"},"Şube Adı"),e("th",{class:"p-3 border-b"},"Adres"),e("th",{class:"p-3 border-b"},"NACE Kodu"),e("th",{class:"p-3 border-b"},"Tehlike Sınıfı"),e("th",{class:"p-3 border-b"},"Telefon"),e("th",{class:"p-3 border-b"},"Yetkili"),e("th",{class:"p-3 border-b"},"SGK Sicil No"),e("th",{class:"p-3 border-b text-center"},"İşlemler")])],-1)),e("tbody",null,[(r(!0),d(g,null,y(j(N),s=>(r(),d("tr",{key:s.id,class:"border-b"},[e("td",G,a(s.firma.firmaAdi),1),e("td",L,a(s.subeAdi),1),e("td",P,a(s.adres),1),e("td",O,a(s.nace.kod),1),e("td",Q,a(s.nace.tehlikeSinifi),1),e("td",X,a(s.telefon),1),e("td",I,a(s.yetkili),1),e("td",J,a(s.sgkSicilNo),1),e("td",R,[e("button",{onClick:i=>F(s),class:"bg-yellow-500 hover:bg-yellow-600 text-white px-2 py-2 rounded-lg inline-flex items-center"},[u(c,{name:"mdi-pencil",class:"w-5 h-5"})],8,H),e("button",{onClick:i=>l.deleteFirma(s.id),class:"bg-red-500 hover:bg-red-600 text-white px-2 py-2 rounded-lg inline-flex items-center"},[u(c,{name:"mdi-trash-can",class:"w-5 h-5"})],8,W),e("div",Z,[e("button",{onClick:i=>Y(s.id),class:"bg-gray-500 hover:bg-gray-600 text-white px-2 py-2 rounded-lg inline-flex items-center"},[u(c,{name:"mdi-dots-vertical",class:"w-5 h-5"})],8,ee),f.value===s.id?(r(),d("div",te,[e("ul",se,[e("li",null,[e("button",{onClick:i=>A(s.firma.id,s.id),class:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center"},[u(c,{name:"mdi-plus",class:"w-5 h-5 mr-2 text-gray-500 align-middle leading-none"}),t[1]||(t[1]=e("span",{class:"align-middle leading-none"},"Çalışan Ekle",-1))],8,le)])])])):S("",!0)])])]))),128))])]),b.value?(r(),d("div",oe,[e("div",ae,[e("h2",ne,a(h.value?"Yerleşke Düzenle":"Yeni Yerleşke Ekle"),1),e("form",{onSubmit:B(K,["prevent"])},[(r(!0),d(g,null,y(n.value,(s,i)=>(r(),d("div",{class:"mb-4",key:i},[e("label",ie,a(i),1),w(e("input",{"onUpdate:modelValue":M=>n.value[i]=M,type:"text",class:"border p-2 w-full rounded-md",required:""},null,8,de),[[k,n.value[i]]])]))),128)),e("button",re,[u(c,{name:"mdi-content-save",class:"w-5 h-5"}),t[3]||(t[3]=e("span",null,"Kaydet",-1))]),e("button",{onClick:_,class:"bg-red-600 text-white py-2 px-4 mt-3 rounded-md w-full flex items-center justify-center space-x-2"},[u(c,{name:"mdi-close",class:"w-5 h-5"}),t[4]||(t[4]=e("span",null,"Kapat",-1))])],32)])])):S("",!0)]),t[6]||(t[6]=e("br",null,null,-1)),t[7]||(t[7]=e("br",null,null,-1))],64)}}};export{be as default};
