import j from"./DyiwFOnw.js";import{_ as O}from"./CwfwSP2l.js";import{r as p,n as K,m as v,c as a,a as e,p as d,u as m,D as i,E,v as Q,F as $,q as H,t as n,s as W,G as X,z as N,b,w as P,o as r,d as x}from"./B8_WjUqw.js";import{u as S}from"./BMbFKR4x.js";const J={class:"p-4 max-w-full mx-auto bg-white rounded-lg shadow-lg"},Z={class:"mb-4 flex justify-between items-center"},ee={class:"w-full border-collapse bg-white text-left shadow-md rounded-md"},te={class:"p-3"},se={class:"p-3"},le={class:"p-3"},ie={class:"p-3"},oe={class:"p-3"},ae={class:"p-3"},re={key:0,class:"text-green-500"},ne={key:1},de={class:"p-3"},ue={class:"p-3"},pe={class:"p-3"},ce={key:0},me={key:1},be={class:"p-3"},ge={key:0},fe={key:1},ke={class:"p-3"},ye={key:0},he=["href"],ve={key:1},xe={class:"p-3"},_e={key:0},we={key:1},Ce={class:"p-3"},De={key:0},Se=["href"],Te={key:1},Ue={class:"p-3 text-center"},Ae={class:"relative"},Re=["onClick"],Me={key:0,class:"absolute right-0 mt-2 w-40 bg-white border rounded-lg shadow-lg z-50"},Ve={class:"py-1"},Ee=["onClick"],$e=["onClick"],Ne={class:"mt-4 flex justify-between items-center"},Pe=["disabled"],qe=["disabled"],Fe={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50"},Ge={class:"bg-white p-6 rounded-lg shadow-lg max-w-md w-full"},Le={class:"mb-4"},Ie={class:"mb-4"},ze={class:"mb-4"},Be={class:"mb-4"},Ye={class:"mb-4"},je={class:"mb-4"},Oe={class:"mb-4 flex items-center"},Ke={class:"inline-flex relative items-center cursor-pointer"},Qe={class:"ml-3 text-sm font-medium text-gray-900"},He={class:"mt-4"},tt={__name:"index",setup(We){const k=p([]),g=p(""),_=p(10),u=p(1),w=p(!1),y=p(null),f=p(""),o=p({adi:"",soyadi:"",tc_no:"",meslegi:"",firmaId:0,firmaYerleskeId:0,isegiristarihi:"",isecikistaarihi:null,aktif:!0});K(()=>{C(),console.log("Sayfa Yüklendi"),console.log("DATA",k)});const C=async()=>{const{data:l}=await S("/api/calisan/get","$4WsoNLA3nw");k.value=l.value},T=l=>{const t=new Date,h=new Date(l)-t,s=Math.ceil(h/(1e3*60*60*24));return s>=0?s:0};v(()=>k.value.filter(l=>l.tc_no.toString().includes(g.value)));const U=v(()=>k.value.filter(l=>{const t=f.value===""||String(l.aktif)===f.value,c=l.tc_no.toString().includes(g.value);return t&&c})),D=v(()=>Math.ceil(U.value.length/_.value)),q=v(()=>{const l=(u.value-1)*_.value,t=l+_.value;return U.value.slice(l,t)}),F=()=>{u.value<D.value&&u.value++},G=()=>{u.value>1&&u.value--},L=()=>{w.value=!0,y.value=null},A=()=>{w.value=!1},I=async()=>{await S(`/api/calisan/${o.value.id}`,{method:"PUT",body:o.value},"$Xgb0rE24Nf"),C(),A()},z=l=>{o.value={...l,isegiristarihi:R(l.isegiristarihi),isecikistaarihi:l.isecikistaarihi?R(l.isecikistaarihi):null},L()},R=l=>new Date(l).toISOString().split("T")[0],B=async l=>{try{await S(`/api/calisan/${l}`,{method:"DELETE"},"$oQq0ChEwaa"),alert("Çalışan başarıyla silindi"),C()}catch(t){alert("Çalışan silinirken bir hata oluştu"),console.error(t)}},Y=l=>{y.value=y.value===l?null:l},M=l=>l?new Date(l).toLocaleDateString("tr-TR",{day:"2-digit",month:"2-digit",year:"numeric"}):"";return(l,t)=>{const c=j,h=O;return r(),a($,null,[e("div",J,[t[27]||(t[27]=e("h1",{class:"text-3xl font-semibold mb-6 text-gray-800"},"Çalışanlar",-1)),e("div",Z,[e("div",null,[d(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>E(g)?g.value=s:null),type:"text",placeholder:"TC No ile Ara...",class:"w-48 p-2 border rounded-lg"},null,512),[[m,i(g)]])]),e("div",null,[t[10]||(t[10]=e("label",{for:"durum",class:"block text-sm font-medium text-gray-600 text-center"},"Durum",-1)),d(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>E(f)?f.value=s:null),id:"durum",class:"border p-2 w-48 rounded-lg"},t[9]||(t[9]=[e("option",{value:""},"Tümü",-1),e("option",{value:"true"},"Aktif",-1),e("option",{value:"false"},"Pasif",-1)]),512),[[Q,i(f)]])])]),e("table",ee,[t[16]||(t[16]=e("thead",null,[e("tr",{class:"bg-gray-200 text-gray-700"},[e("th",{class:"p-3 border-b"},"Adı"),e("th",{class:"p-3 border-b"},"Soyadı"),e("th",{class:"p-3 border-b"},"TC"),e("th",{class:"p-3 border-b"},"Mesleği"),e("th",{class:"p-3 border-b"},"İşe Giriş Tarihi"),e("th",{class:"p-3 border-b"},"İşden Çıkış Tarihi"),e("th",{class:"p-3 border-b"},"Aktif"),e("th",{class:"p-3 border-b"},"Firma Adı"),e("th",{class:"p-3 border-b"},"Taşeron Adı"),e("th",{class:"p-3 border-b"},"Sağlık Raporu (Gün)"),e("th",{class:"p-3 border-b"},"Sağlık Raporu URL"),e("th",{class:"p-3 border-b"},"Sertifika (Gün)"),e("th",{class:"p-3 border-b"},"Sertifika URL"),e("th",{class:"p-3 border-b text-center"},"İşlemler")])],-1)),e("tbody",null,[(r(!0),a($,null,H(i(q),s=>(r(),a("tr",{key:s.id,class:"border-b"},[e("td",te,n(s.adi),1),e("td",se,n(s.soyadi),1),e("td",le,n(s.tc_no),1),e("td",ie,n(s.meslegi),1),e("td",oe,n(M(s.isegiristarihi)),1),e("td",ae,[s.isecikistaarihi===null?(r(),a("span",re,"Devam Ediyor")):(r(),a("span",ne,n(M(s.isecikistaarihi)),1))]),e("td",de,n(s.aktif?"Evet":"Hayır"),1),e("td",ue,n(s.firma.firmaAdi),1),e("td",pe,[s.yerleske&&s.yerleske.subeAdi?(r(),a("span",ce,n(s.yerleske.subeAdi),1)):(r(),a("span",me,"Merkez"))]),e("td",be,[s.saglikRaporlari.length?(r(),a("div",ge,[e("div",null,n(T(s.saglikRaporlari[s.saglikRaporlari.length-1].gecerlilikTarihi))+" - gün ",1)])):(r(),a("div",fe," - "))]),e("td",ke,[s.saglikRaporlari.length?(r(),a("div",ye,[e("div",null,[e("a",{href:s.saglikRaporlari[s.saglikRaporlari.length-1].raporUrl,target:"_blank"},t[11]||(t[11]=[e("span",{class:"text-lg text-red-700"},"Raporu Görüntüle",-1)]),8,he)])])):(r(),a("div",ve," Sağlık raporu yok "))]),e("td",xe,[s.sertifikalar.length?(r(),a("div",_e,[e("div",null,n(T(s.sertifikalar[s.sertifikalar.length-1].gecerlilikTarihi))+" - gün ",1)])):(r(),a("div",we," - "))]),e("td",Ce,[s.sertifikalar.length?(r(),a("div",De,[e("div",null,[e("a",{href:s.sertifikalar[s.sertifikalar.length-1].sertifikaUrl,target:"_blank"},t[12]||(t[12]=[e("span",{class:"text-lg text-blue-500"},"Sertikika Görüntüle",-1)]),8,Se)])])):(r(),a("div",Te," Sertifika yok "))]),e("td",Ue,[e("div",Ae,[e("button",{onClick:V=>Y(s.id),class:"bg-gray-500 hover:bg-gray-600 text-white px-2 py-1 rounded-lg"},[b(c,{name:"mdi-dots-vertical",class:"w-5 h-5"})],8,Re),i(y)===s.id?(r(),a("div",Me,[e("ul",Ve,[e("li",null,[e("button",{onClick:V=>z(s),class:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center"},[b(c,{name:"mdi-pencil",class:"w-4 h-4 mr-2"}),t[13]||(t[13]=x(" Düzenle "))],8,Ee)]),e("li",null,[e("button",{onClick:V=>B(s.id),class:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center"},[b(c,{name:"mdi-delete",class:"w-4 h-4 mr-2"}),t[14]||(t[14]=x(" Sil "))],8,$e)]),e("li",null,[b(h,{to:`/calisanlar/dokuman/yukle?calisanId=${s.id}&calisanAdi=${s.adi}&calisanSoyadi=${s.soyadi}`,class:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center"},{default:P(()=>[b(c,{name:"mdi-book-plus",class:"w-4 h-4 mr-2"}),t[15]||(t[15]=x(" Belge Yükle "))]),_:2},1032,["to"])])])])):N("",!0)])])]))),128))])]),e("div",Ne,[e("button",{onClick:G,disabled:i(u)===1,class:"bg-gray-500 text-white py-2 px-4 rounded-lg"},"Önceki",8,Pe),e("span",null,"Sayfa "+n(i(u))+" / "+n(i(D)),1),e("button",{onClick:F,disabled:i(u)===i(D),class:"bg-gray-500 text-white py-2 px-4 rounded-lg"},"Sonraki",8,qe)]),i(w)?(r(),a("div",Fe,[e("div",Ge,[t[26]||(t[26]=e("h2",{class:"text-2xl mb-4"},"Yeni Çalışan Ekle",-1)),e("form",{onSubmit:W(I,["prevent"])},[e("div",Le,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-600"},"Adı",-1)),d(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>i(o).adi=s),type:"text",class:"border p-2 w-full rounded-md",required:""},null,512),[[m,i(o).adi]])]),e("div",Ie,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-600"},"Soyadı",-1)),d(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>i(o).soyadi=s),type:"text",class:"border p-2 w-full rounded-md",required:""},null,512),[[m,i(o).soyadi]])]),e("div",ze,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-600"},"TC No",-1)),d(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>i(o).tc_no=s),type:"text",class:"border p-2 w-full rounded-md",required:"",maxlength:"11"},null,512),[[m,i(o).tc_no]])]),e("div",Be,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-600"},"Mesleği",-1)),d(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>i(o).meslegi=s),type:"text",class:"border p-2 w-full rounded-md",required:""},null,512),[[m,i(o).meslegi]])]),e("div",Ye,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-600"},"İşe Giriş Tarihi",-1)),d(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>i(o).isegiristarihi=s),type:"date",class:"border p-2 w-full rounded-md",required:""},null,512),[[m,i(o).isegiristarihi]])]),e("div",je,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-600"},"İşten Çıkış Tarihi (Opsiyonel)",-1)),d(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>i(o).isecikistaarihi=s),type:"date",class:"border p-2 w-full rounded-md"},null,512),[[m,i(o).isecikistaarihi]])]),e("div",Oe,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-600 mr-4"},"Durum",-1)),e("label",Ke,[d(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>i(o).aktif=s),type:"checkbox",class:"sr-only peer"},null,512),[[X,i(o).aktif]]),t[23]||(t[23]=e("div",{class:"w-11 h-6 bg-gray-200 rounded-full peer-checked:bg-blue-600 peer-focus:ring-4 peer-focus:ring-blue-300 transition-all duration-300"},[e("div",{class:"absolute left-0.5 top-0.5 w-5 h-5 bg-white rounded-full transition-transform duration-300 peer-checked:translate-x-5"})],-1)),e("span",Qe,n(i(o).aktif?"Aktif":"Pasif"),1)])]),e("div",{class:"space-y-2"},[t[25]||(t[25]=e("button",{type:"submit",class:"bg-blue-600 text-white py-2 px-4 rounded-md w-full"},"Kaydet",-1)),e("button",{onClick:A,class:"bg-red-600 text-white py-2 px-4 rounded-md w-full"},"Kapat")])],32)])])):N("",!0)]),e("div",He,[b(h,{to:"/calisanlar/ekle-excel",class:"bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md"},{default:P(()=>t[28]||(t[28]=[x(" Excel ile Ekle ")])),_:1})])],64)}}};export{tt as default};
