import Z from"./DyiwFOnw.js";import{r as n,y as ee,n as le,m as te,c as d,a as e,p as u,u as c,b as p,w as ae,T as se,F as y,q as _,o as r,t as i,s as ie,v as T,H as oe,z as b,d as ne}from"./B8_WjUqw.js";import{u as f}from"./BMbFKR4x.js";const de={class:"p-4 max-w-full mx-auto bg-white rounded-lg shadow-lg"},re={class:"flex flex-wrap items-center mb-4"},ue={key:0,class:"fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50"},ce={class:"bg-white rounded-lg shadow-lg p-6 w-full max-w-lg"},pe={class:"text-2xl font-medium text-gray-700 mb-4"},me={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ve=["value"],ge={class:"col-span-1 md:col-span-2"},be=["value"],ye={key:0,class:"mt-4"},fe=["value","onChange"],ke={class:"p-4 max-w-full mx-auto bg-white rounded-lg shadow-lg"},xe={class:"w-full border-collapse bg-white text-left shadow-md rounded-md"},he={class:"border-b hover:bg-gray-50"},we={class:"p-3"},Se=["onClick"],_e={class:"p-3"},Ce={class:"p-3"},Ke={class:"p-3"},Ae={class:"p-3"},Fe={class:"p-3"},Ne={class:"p-3"},Ee={class:"p-3"},$e={class:"p-3"},Te={class:"p-3"},Ve={class:"p-3"},Ue={class:"p-3 text-center flex justify-center space-x-2"},De=["onClick"],qe=["onClick"],Ie={class:"relative"},Le=["onClick"],Me={key:0,class:"absolute right-0 mt-2 w-40 bg-white border border-gray-200 rounded-lg shadow-lg z-50"},Ge={class:"py-1"},ze=["onClick"],Ye=["onClick"],je=["onClick"],He={key:0,class:"bg-gray-300"},Pe={class:"p-3"},Oe={class:"p-3"},Be={class:"p-3"},Re={class:"p-3"},Je={class:"p-3"},Qe={class:"p-3"},Xe={class:"p-3"},We={class:"p-3 text-center flex justify-center space-x-2"},Ze={class:"relative"},el=["onClick"],ll={key:0,class:"absolute right-0 mt-2 w-40 bg-white border border-gray-200 rounded-lg shadow-lg z-50"},tl={class:"py-1"},al=["onClick"],dl={__name:"index",setup(sl){const N=n(!1);n(0),n(0);const k=ee(),C=n(null),K=n(null),x=n([]);n(null);const V=n([]),v=n(null),A=n({}),h=n(null),F=n([]),w=n({name:"",yetkili:""}),U=["Akseki","Aksu","Alanya","Demre","Döşemealtı","Elmalı","Finike","Gazipaşa","Gündoğmuş","İbradı","Kaş","Kemer","Kepez","Konyaaltı","Korkuteli","Kumluca","Manavgat","Muratpaşa","Serik"],D=s=>{K.value=K.value===s?null:s},q=(s,l)=>{k.push({path:"/calisanlar/ekle",query:{firmaId:s,yerleskeId:l}})},I=s=>{k.push({path:"/calisanlar/ekle",query:{firmaId:s}})},L=async s=>{v.value===s?(v.value=null,V.value=[]):(v.value=s,A.value[s]||await M(s))},M=async s=>{console.log("Menu Gelen FirmaID:",s);try{const{data:l}=await f(`/api/yerleske/getByFirmaId?firmaId=${s}`,"$bH1gKHCGET");A.value[s]=l.value||[]}catch(l){console.error("Şubeler yüklenirken hata oluştu:",l)}},G=s=>{C.value=C.value===s?null:s},z=s=>{N.value=!1,k.push(`/yerleske/ekle?firmaId=${s}`)},Y=s=>{N.value=!1,k.push(`/firma/takvim?firmaId=${s}`)},j=n(),a=n({firmaKodu:"",firmaAdi:"",adres:"",il:"",ilce:"",telefon:"",email:"",yetkili:"",naceId:0,isgkSicilNo:"",tehlikeSinifi:""}),g=n(!1),S=async()=>{const{data:s}=await f("/api/firma/get","$S7PxOq2HcU");F.value=s.value},E=async()=>{try{const{data:s}=await f("/api/firma/getLatestFirmaKodu","$hfCL3jwUKf");s.value&&s.value.success?(j.value=s.value.nextFirmaKodu,a.value.firmaKodu=String(s.value.nextFirmaKodu),console.log("GELENKOD",s)):console.error("Firma kodu alınamadı.")}catch(s){console.error("Hata:",s)}};le(()=>{S(),E(),console.log("Sayfa Yüklendi"),console.log("DATA",F)});const H=te(()=>F.value.filter(s=>s.firmaAdi.toLowerCase().includes(w.value.name.toLowerCase())&&s.yetkili.toLowerCase().includes(w.value.yetkili.toLowerCase()))),$=()=>{g.value=!g.value,P()},P=()=>{a.value={firmaKodu:"",firmaAdi:"",adres:"",il:"",ilce:"",telefon:"",email:"",yetkili:"",naceId:"",isgkSicilNo:"",tehlikeSinifi:""}},O=async()=>{h.value?(await f(`/api/firma/${h.value.id}`,{method:"PUT",body:{firmaKodu:a.value.firmaKodu,firmaAdi:a.value.firmaAdi,adres:a.value.adres,il:a.value.il,ilce:a.value.ilce,telefon:a.value.telefon,email:a.value.email,yetkili:a.value.yetkili,naceId:a.value.naceId,isgkSicilNo:a.value.isgkSicilNo,tehlikeSinifi:a.value.tehlikeSinifi}},"$8536HjH4g2"),S(),h.value=null,g.value=!1):(await $fetch("/api/firma/post",{method:"POST",body:{firmaKodu:a.value.firmaKodu,firmaAdi:a.value.firmaAdi,adres:a.value.adres,il:a.value.il,ilce:a.value.ilce,telefon:a.value.telefon,email:a.value.email,yetkili:a.value.yetkili,naceId:a.value.naceId,isgkSicilNo:a.value.isgkSicilNo}}),alert("Firma başarıyla eklendi!"),g.value=!1,S())},B=s=>{h.value={...s},a.value={...s},g.value=!0},R=async s=>{await $fetch("/api/firma/delete",{method:"DELETE",body:{id:s}}),S()},J=s=>new Promise(l=>setTimeout(l,s)),Q=async()=>{if(a.value.isgkSicilNo.length>=4){await J(3e3);const{data:s}=await f("/api/firma/nace-search",{method:"POST",body:{sgkSicilNo:a.value.isgkSicilNo}},"$RFbJpXjYGF");x.value=s.value||[]}else x.value=[]},X=s=>{a.value.tehlikeSinifi=s.tehlikeSinifi};return(s,l)=>{const m=Z;return r(),d("div",de,[l[34]||(l[34]=e("h1",{class:"text-3xl font-semibold mb-6 text-gray-800"},"Firmalar",-1)),e("div",re,[u(e("input",{"onUpdate:modelValue":l[0]||(l[0]=t=>w.value.name=t),type:"text",placeholder:"Firma Adında Ara",class:"w-full md:w-1/6 p-2 border rounded-lg mr-2 mb-2"},null,512),[[c,w.value.name]]),e("button",{onClick:$,class:"bg-blue-600 hover:bg-blue-700 text-white px-5 py-2 rounded-lg shadow-md ml-auto mb-2 transition duration-300"}," Yeni Firma Ekle ")]),p(se,{name:"fade"},{default:ae(()=>[g.value?(r(),d("div",ue,[e("div",ce,[e("h2",pe,i(a.value.id?"Firmayı Düzenle":"Yeni Firma Ekle"),1),e("form",{onSubmit:ie(O,["prevent"])},[e("div",me,[e("div",null,[l[12]||(l[12]=e("label",{class:"block text-gray-600 mb-1"},"Firma Kodu",-1)),e("input",{value:a.value.firmaKodu,type:"text",class:"w-24 p-3 border rounded-lg",placeholder:"Firma kodu yükleniyor...",required:""},null,8,ve),e("button",{onClick:E,type:"button",class:"px-4 py-2 mx-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg shadow-md"},"KodAl")]),e("div",null,[l[13]||(l[13]=e("label",{class:"block text-gray-600 mb-1"},"Firma Adı",-1)),u(e("input",{"onUpdate:modelValue":l[1]||(l[1]=t=>a.value.firmaAdi=t),type:"text",class:"w-full p-3 border rounded-lg",required:""},null,512),[[c,a.value.firmaAdi]])]),e("div",ge,[l[14]||(l[14]=e("label",{class:"block text-gray-600 mb-1"},"Adres",-1)),u(e("input",{"onUpdate:modelValue":l[2]||(l[2]=t=>a.value.adres=t),type:"text",class:"w-full p-3 border rounded-lg",required:""},null,512),[[c,a.value.adres]])]),e("div",null,[l[16]||(l[16]=e("label",{class:"block text-gray-600 mb-1"},"İl",-1)),u(e("select",{"onUpdate:modelValue":l[3]||(l[3]=t=>a.value.il=t),class:"w-full p-3 border rounded-lg",required:""},l[15]||(l[15]=[e("option",{value:"Antalya"},"Antalya",-1)]),512),[[T,a.value.il]])]),e("div",null,[l[18]||(l[18]=e("label",{class:"block text-gray-600 mb-1"},"İlçe",-1)),u(e("select",{"onUpdate:modelValue":l[4]||(l[4]=t=>a.value.ilce=t),class:"w-full p-3 border rounded-lg",required:""},[l[17]||(l[17]=e("option",{disabled:"",value:""},"Lütfen bir ilçe seçiniz",-1)),(r(),d(y,null,_(U,t=>e("option",{key:t,value:t},i(t),9,be)),64))],512),[[T,a.value.ilce]])]),e("div",null,[l[19]||(l[19]=e("label",{class:"block text-gray-600 mb-1"},"SGK Sicil No",-1)),u(e("input",{"onUpdate:modelValue":l[5]||(l[5]=t=>a.value.isgkSicilNo=t),type:"text",class:"w-full p-3 border rounded-lg",required:"",onInput:Q},null,544),[[c,a.value.isgkSicilNo]])]),x.value.length>0?(r(),d("div",ye,[l[20]||(l[20]=e("label",{class:"block text-gray-600 mb-1"},"NACE Kodları",-1)),(r(!0),d(y,null,_(x.value,t=>(r(),d("div",{key:t.id,class:"flex items-center"},[u(e("input",{type:"radio",value:t.id,"onUpdate:modelValue":l[6]||(l[6]=o=>a.value.naceId=o),onChange:o=>X(t),class:"mr-2"},null,40,fe),[[oe,a.value.naceId]]),e("span",null,i(t.kod)+" - ("+i(t.tehlikeSinifi)+")",1)]))),128))])):b("",!0),e("div",null,[l[21]||(l[21]=e("label",{class:"block text-gray-600 mb-1"},"NACE Kodu ID",-1)),u(e("input",{"onUpdate:modelValue":l[7]||(l[7]=t=>a.value.naceId=t),type:"text",class:"w-full p-3 border rounded-lg",required:""},null,512),[[c,a.value.naceId]])]),e("div",null,[l[22]||(l[22]=e("label",{class:"block text-gray-600 mb-1"},"Tehlike Sınıfı",-1)),u(e("input",{"onUpdate:modelValue":l[8]||(l[8]=t=>a.value.tehlikeSinifi=t),type:"text",class:"w-full p-3 border rounded-lg"},null,512),[[c,a.value.tehlikeSinifi]])]),e("div",null,[l[23]||(l[23]=e("label",{class:"block text-gray-600 mb-1"},"Telefon",-1)),u(e("input",{"onUpdate:modelValue":l[9]||(l[9]=t=>a.value.telefon=t),type:"text",class:"w-full p-3 border rounded-lg"},null,512),[[c,a.value.telefon]])]),e("div",null,[l[24]||(l[24]=e("label",{class:"block text-gray-600 mb-1"},"Email",-1)),u(e("input",{"onUpdate:modelValue":l[10]||(l[10]=t=>a.value.email=t),type:"text",class:"w-full p-3 border rounded-lg"},null,512),[[c,a.value.email]])]),e("div",null,[l[25]||(l[25]=e("label",{class:"block text-gray-600 mb-1"},"Yetkili",-1)),u(e("input",{"onUpdate:modelValue":l[11]||(l[11]=t=>a.value.yetkili=t),type:"text",class:"w-full p-3 border rounded-lg",required:""},null,512),[[c,a.value.yetkili]])])]),e("div",{class:"mt-6 flex justify-end"},[e("button",{onClick:$,type:"button",class:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg shadow-md mr-2"},"İptal"),l[26]||(l[26]=e("button",{type:"submit",class:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg shadow-md"},"Kaydet",-1))])],32)])])):b("",!0)]),_:1}),e("div",ke,[l[33]||(l[33]=e("h1",{class:"text-3xl font-semibold mb-6 text-gray-800"},"Firmalar",-1)),e("table",xe,[l[32]||(l[32]=e("thead",null,[e("tr",{class:"bg-gray-200 text-gray-700"},[e("th",{class:"p-3 text-left"},"Firma Kodu"),e("th",{class:"p-3 text-left"},"Firma Adı"),e("th",{class:"p-3 text-left"},"Adres"),e("th",{class:"p-3 text-left"},"İl"),e("th",{class:"p-3 text-left"},"İlçe"),e("th",{class:"p-3 text-left"},"Telefon"),e("th",{class:"p-3 text-left"},"Email"),e("th",{class:"p-3 text-left"},"Yetkili"),e("th",{class:"p-3 text-left"},"NACE Kodu"),e("th",{class:"p-3 text-left"},"Teklike Sınıfı"),e("th",{class:"p-3 text-left"},"SGK Sicil No"),e("th",{class:"p-3 text-center"},"İşlemler")])],-1)),e("tbody",null,[(r(!0),d(y,null,_(H.value,t=>(r(),d(y,{key:t.id},[e("tr",he,[e("td",we,[e("button",{onClick:o=>L(t.id),class:"text-blue-500 hover:text-blue-700"},i(v.value===t.id?"<":">"),9,Se),ne(" "+i(t.firmaKodu),1)]),e("td",_e,i(t.firmaAdi),1),e("td",Ce,i(t.adres),1),e("td",Ke,i(t.il),1),e("td",Ae,i(t.ilce),1),e("td",Fe,i(t.telefon),1),e("td",Ne,i(t.email),1),e("td",Ee,i(t.yetkili),1),e("td",$e,i(t.nace.kod),1),e("td",Te,i(t.nace.tehlikeSinifi),1),e("td",Ve,i(t.isgkSicilNo),1),e("td",Ue,[e("button",{onClick:o=>B(t),class:"bg-yellow-500 hover:bg-yellow-600 text-white px-2 py-2 rounded-lg inline-flex items-center"},[p(m,{name:"mdi-pencil",class:"w-5 h-5"})],8,De),e("button",{onClick:o=>R(t.id),class:"bg-red-500 hover:bg-red-600 text-white px-2 py-2 rounded-lg inline-flex items-center"},[p(m,{name:"mdi-trash-can",class:"w-5 h-5"})],8,qe),e("div",Ie,[e("button",{onClick:o=>G(t.id),class:"bg-gray-500 hover:bg-gray-600 text-white px-2 py-2 rounded-lg inline-flex items-center"},[p(m,{name:"mdi-dots-vertical",class:"w-5 h-5"})],8,Le),C.value===t.id?(r(),d("div",Me,[e("ul",Ge,[e("li",null,[e("button",{onClick:o=>z(t.id),class:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center"},[p(m,{name:"mdi-plus",class:"w-5 h-5 mr-2 text-gray-500 align-middle leading-none"}),l[27]||(l[27]=e("span",{class:"align-middle leading-none"},"Taşeron Ekle",-1))],8,ze),e("button",{onClick:o=>Y(t.id),class:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center"},[p(m,{name:"mdi-calendar",class:"w-5 h-5 mr-2 text-gray-500 align-middle leading-none"}),l[28]||(l[28]=e("span",{class:"align-middle leading-none"},"Eğitim Planı",-1))],8,Ye),e("button",{onClick:o=>I(t.id),class:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center"},[p(m,{name:"mdi-plus",class:"w-5 h-5 mr-2 text-gray-500 align-middle leading-none"}),l[29]||(l[29]=e("span",{class:"align-middle leading-none"},"Çalışan Ekle",-1))],8,je)])])])):b("",!0)])])]),v.value===t.id?(r(),d("tr",He,l[30]||(l[30]=[e("th",{class:"p-3 border-b"},"Taşeron Adı",-1),e("th",{class:"p-3 border-b"},"Adres",-1),e("th",{class:"p-3 border-b"},"NACE Kodu",-1),e("th",{class:"p-3 border-b"},"Tehlike Sınıfı",-1),e("th",{class:"p-3 border-b"},"Telefon",-1),e("th",{class:"p-3 border-b"},"Yetkili",-1),e("th",{class:"p-3 border-b"},"SGK Sicil No",-1),e("th",{class:"p-3 border-b text-center"},"İşlemler",-1)]))):b("",!0),v.value===t.id?(r(!0),d(y,{key:1},_(A.value[t.id],o=>(r(),d("tr",{key:o.id,class:"bg-gray-100"},[e("td",Pe,i(o.subeAdi),1),e("td",Oe,i(o.adres),1),e("td",Be,i(o.nace.kod),1),e("td",Re,i(o.nace.tehlikeSinifi),1),e("td",Je,i(o.telefon),1),e("td",Qe,i(o.yetkili),1),e("td",Xe,i(o.sgkSicilNo),1),e("td",We,[e("div",Ze,[e("button",{onClick:W=>D(o.id),class:"bg-gray-500 hover:bg-gray-600 text-white px-2 py-2 rounded-lg inline-flex items-center"},[p(m,{name:"mdi-dots-vertical",class:"w-5 h-5"})],8,el),K.value===o.id?(r(),d("div",ll,[e("ul",tl,[e("li",null,[e("button",{onClick:W=>q(o.firma.id,o.id),class:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center"},[p(m,{name:"mdi-plus",class:"w-5 h-5 mr-2 text-gray-500 align-middle leading-none"}),l[31]||(l[31]=e("span",{class:"align-middle leading-none"},"Çalışan Ekle",-1))],8,al)])])])):b("",!0)])])]))),128)):b("",!0)],64))),128))])])])])}}};export{dl as default};
